# 面试题-网络

## 参考资料

[2019 网络编程面试题](https://segmentfault.com/a/1190000020260391)

### 面试题

### 1.网络分层

OSI 七层协议模型主要是

1. 应用层（Application）
2. 表示层（Presentation）
3. 会话层（Session）
4. 传输层（Transport）
5. 网络层（Network）
6. 数据链路层（Data Link）
7. 物理层（Physical）

### 2.TCP/IP 五层模型

1. 应用层（Application）、
2. 传输层（Transport）、
3. 网络层（Network）、
4. 数据链路层（Data Link）、
5. 物理层（Physical）。

### 3.三次握手与四次挥手

- 第一次握手：
  客户端发送 syn 包(syn=j)到服务器，并进入 SYN_SEND 状态，等待服务器确认；
- 第二次握手：
  服务器收到 syn 包，必须确认客户的 SYN（ack=j+1），同时自己也发送一个 SYN 包（syn=k），即 SYN+ACK 包，此时服务器进入 SYN_RECV 状态；
- 第三次握手：
  客户端收到服务器的 SYN ＋ ACK 包，向服务器发送确认包 ACK(ack=k+1)，此包发送完毕，客户端和服务器进入 ESTABLISHED 状态，完成三次握手。

握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。
理想状态下，TCP 连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP 连接都将被一直保持下去。

断开连接时服务器和客户端均可以主动发起断开 TCP 连接的请求，断开过程需要经过“四次握手”

- 第一次挥手：
  客户端发送报文告诉服务器没有数据要发送了
- 第二次挥手：
  服务端收到，再发送给客户端告诉它我收到了
- 第三次挥手：
  服务端向客户端发送报文，请求关闭连接
- 第四次挥手：
  客户端收到关闭连接的请求，向服务端发送报文，服务端关闭连接

### 4.TCP 为什么三次握手不是两次握手，为什么两次握手不安全

- 为了实现可靠数据传输， TCP 协议的通信双方， 都必须维护一个序列号， 以标识发送出去的数据包中， 哪些是已经被对方收到的。
- 三次握手的过程即是通信双方相互告知序列号起始值， 并确认对方已经收到了序列号起始值的必经步骤。
- 如果只是两次握手， 至多只有连接发起方的起始序列号能被确认， 另一方选择的序列号则得不到确认。

### 5.为什么 TCP 是可靠的，UDP 早不可靠的?为什么 UDP 比 TCP 快?

TCP/IP 协议拥有三次握手双向机制，这一机制保证校验了数据，保证了他的可靠性。
UDP 就没有了，udp 信息发出后,不验证是否到达对方,所以不可靠。

### 6.http 协议

http 协议是一个基于请求与响应模式的无连接，无状态，应用层的协议，支持 c/s 模式，简单快速，灵活。

- 简单快速：协议简单，通信速度快
- 灵活：允许传输任意类型的数据对象，由 Content-Type 标记
- 无连接：每次处理一个请求，处理完成后既断开
- 无状态：对事务处理没有记忆能力

http 有两种报文：请求报文和响应报文

请求报文由请求行，请求报头，和请求数据组成

- 请求行：抓包第一行，包括请求方法，url 和 http 版本
- 请求报头：指的就是题目中“里面的协议头部”
- 请求数据：指 post 方式提交的表单数据

响应报文由状态行，响应报头，响应正文组成

- 状态行：状态码
- 响应报头：同请求报头
- 响应正文：服务器返回的资源数据

接下来是 http 头部，既请求报头和响应报头，统称消息报头。

消息报头可以分为通用报头，请求报头，响应报头，实体报头等。

通用报头和实体报头既可以出现在请求报头中，也可以出现在响应报头中。

- 通用报头包含的字段如：Date Connection Cache-Control
- 实体报头中有 Content-Type Content-Length Content-Language Content-Encoding.
- 请求报头中包含的字段有：Host,User-Agent,Accept-Encoding,Accept-Language,Connection
- 响应报头包含的字段：Location，Server

### 7.http 的 get 和 post 的区别

http 是应用层的协议，底层基于 TCP/IP 协议，所以本质上，get 和 post 请求都是 TCP 请求。所以二者的区别都是体现在应用层上（HTTP 的规定和浏览器/服务器的限制）

1. 参数的传输方式：GET 参数通过 URL 传递，POST 放在 Request body 中。
2. GET 请求在 URL 中传送的参数是有长度限制的，而 POST 没有。
3. 对于 GET 方式的请求，浏览器会把 http header 和 data 一并发送出去，服务器响应 200（返回数据）；而对于 POST，浏览器先发送 header，服务器响应 100 continue，浏览器再发送 data，服务器响应 200 ok（返回数据）。不过要注意，并不是所有浏览器都会在 POST 中发送两次包，比如火狐
4. 对参数的数据类型，GET 只接受 ASCII 字符，而 POST 没有限制。
5. GET 比 POST 更不安全，因为参数直接暴露在 URL 上，所以不能用来传递敏感信息。
6. GET 请求只能进行 url 编码，而 POST 支持多种编码方式。
7. GET 在浏览器回退时是无害的，而 POST 会再次提交请求。
8. GET 产生的 URL 地址可以被 Bookmark，而 POST 不可以。
9. GET 请求会被浏览器主动 cache，而 POST 不会，除非手动设置。

### 8.socket 和 http 的区别：

Http 连接：

- http 连接就是所谓的短连接，及客户端向服务器发送一次请求，服务器端相应后连接即会断掉。

socket 连接：

- socket 连接及时所谓的长连接，理论上客户端和服务端一旦建立连接，则不会主动断掉；但是由于各种环境因素可能会是连接断开，比如说：服务器端或客户端主机 down 了，网络故障，或者两者之间长时间没有数据传输，网络防火墙可能会断开该链接已释放网络资源。所以当一个 socket 连接中没有数据的传输，那么为了位置连续的连接需要发送心跳消息，具体心跳消息格式是开发者自己定义的。

### 9.TCP 与 UDP 区别总结

1. TCP 面向连接（如打电话要先拨号建立连接）;UDP 是无连接的，即发送数据之前不需要建立连接
2. TCP 提供可靠的服务。也就是说，通过 TCP 连接传送的数据，无差错，不丢失，不重复，且按序到达;UDP 尽最大努力交付，即不保证可靠交付
3. TCP 面向字节流，实际上是 TCP 把数据看成一连串无结构的字节流;UDP 是面向报文的 UDP 没有拥塞控制，因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如 IP 电话，实时视频会议等）
4. 每一条 TCP 连接只能是点到点的;UDP 支持一对一，一对多，多对一和多对多的交互通信
5. TCP 首部开销 20 字节;UDP 的首部开销小，只有 8 个字节
6. TCP 的逻辑通信信道是全双工的可靠信道，UDP 则是不可靠信道

全双共、半双工与单工

- 全双工（Full Duplex）是通讯传输的一个术语。
  - 通信允许数据在两个方向上同时传输，它在能力上相当于两个单工通信方式的结合。
  - 全双工指可以同时（瞬时）进行信号的双向传输（A→B 且 B→A）。指 A→B 的同时 B→A，是瞬时同步的，四线制。
- 单工就是在只允许甲方向乙方传送信息，而乙方不能向甲方传送 。
- 半双工(Half Duplex)数据传输指数据可以在一个信号载体的两个方向上传输，但是不能同时传输。
  - 例如，在一个局域网上使用具有半双工传输的技术，一个工作站可以在线上发送数据，然后立即在线上接收数据，这些数据来自数据刚刚传输的方向。像全双工传输一样，半双工包含一个双向线路，两线制。

### 10.https

HTTPS(全称：Hyper Text Transfer Protocol over Secure Socket Layer)，是以安全为目标的 HTTP 通道，简单讲是 HTTP 的安全版。

- HTTP 是应用层协议，位于 HTTP 协议之下是传输协议 TCP。TCP 负责传输，HTTP 则定义了数据如何进行包装，在 HTTP 跟 TCP 中间加多了一层加密层 TLS/SSL，SSL 是个加密套件，负责对 HTTP 的数据进行加密。TLS 是 SSL 的升级版。现在提到 HTTPS，加密套件基本指的是 TLS。
- 传输加密的流程：http 是应用层将数据直接给到 TCP 进行传输，https 是应用层将数据给到 TLS/SSL，将数据加密后，再给到 TCP 进行传输。

#### HTTPS 是如何加密数据的：

一般来说，加密分为对称加密、非对称加密

1. 对称加密

   - 对称加密的意思就是，加密数据用的密钥，跟解密数据用的密钥是一样的。
   - 对称加密的优点在于加密、解密效率通常比较高。缺点在于，数据发送方、数据接收方需要协商、共享同一把密钥，并确保密钥不泄露给其他人。传输过程中容易被截获。

2. 非对称加密
   - 非对称加密的意思就是，加密数据用的密钥（公钥），跟解密数据用的密钥（私钥）是不一样的。
   - 用公钥加密的数据，只有对应的私钥才能解密；用私钥加密的数据，只有对应的公钥才能解密。
   - 公钥需要用数字证书来确保用户身份是真实可靠的。

### 11.加密算法

#### 1.对称加密算法

- Data Encryption Standard(DES)
  - DES 是一种典型的块加密方法：将固定长度的明文通过一系列复杂的操作变成同样长度的密文，块的长度为 64 位。同时，DES 使用的密钥来自定义变换过程，因此算法认为只有持有加密所用的密钥的用户才能解密密文。 DES 的密钥表面上是 64 位的，实际有效密钥长度为 56 位，其余 8 位可以用于奇偶校验。
  - DES 现在已经不被视为一种安全的加密算法，主要原因是它使用的 56 位密钥过短。- 为了提供实用所需的安全性，可以使用 DES 的派生算法 3DES 来进行加密 (虽然 3DES 也存在理论上的攻击方法)。
- Advanced Encryption Standard(AES)
  - AES 在密码学中又称 Rijndael 加密法，用来替代原先的 DES，已经被多方分析且广泛使用。

DES 与 AES 的比较

自 DES 算法公诸于世以来，学术界围绕它的安全性等方面进行了研究并展开了激烈的争论。在技术上，对 DES 的批评主要集中在以下几个方面：

1. 作为分组密码，DES 的加密单位仅有 64 位二进制，这对于数据传输来说太小，因为每个分组仅含 8 个字符，而且其中某些位还要用于奇偶校验或其他通讯开销。
2. DES 的密钥的位数太短，只有 56 比特，而且各次迭代中使用的密钥是递推产生的，这种相关必然降低密码体制的安全性，在现有技术下用穷举法寻找密钥已趋于可行。
3. DES 不能对抗差分和线性密码分析。
4. DES 用户实际使用的密钥长度为 56bit，理论上最大加密强度为 256。DES 算法要提高加密强度（例如增加密钥长度），则系统开销呈指数增长。除采用提高硬件功能和增加并行处理功能外，从算法本身和软件技术方面都无法提高 DES 算法的加密强度。

#### 2.非对称加密算法

RSA

- 1977 年由 MIT 的 Ron Rivest、Adi Shamir 和 Leonard Adleman 一起提出，以他们三人姓氏开头字母命名，是一种获得广泛使用的非对称加密算法。
- 对极大整数做因数分解的难度 (The Factoring Problem) 决定了 RSA 算法的可靠性。换言之，对一个极大整数做因数分解愈困难，RSA 算法就愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。目前看来找到这样的算法的可能性非常小。

DES 与 RSA 的比较

- RSA 算法的密钥很长，具有较好的安全性，但加密的计算量很大，加密速度较慢限制了其应用范围。为减少计算量，在传送信息时，常采用传统加密方法与公开密钥加密方法相结合的方式，即信息采用改进的 DES 对话密钥加密，然后使用 RSA 密钥加密对话密钥和信息摘要。对方收到信息后，用不同的密钥解密并可核对信息摘要。
- 采用 DES 与 RSA 相结合的应用，使它们的优缺点正好互补，即 DES 加密速度快，适合加密较长的报文，可用其加密明文；RSA 加密速度慢，安全性好，应用于 DES 密钥的加密，可解决 DES 密钥分配的问题。
- 目前这种 RSA 和 DES 结合的方法已成为 EMAIL 保密通信标准。
